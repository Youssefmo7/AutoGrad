<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/commons.css">
    <link rel="stylesheet" href="css/TeamProfile.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <title>Edit Team Profile</title>
</head>
<body>
    <div class="container">

        <!-- Header bar -->
        
        <header>
            <div class="logo">
                <img src="pics/logoW.png" alt="Auto Grad">
            </div>
            <p>"Automating Your Graduation Success"</p>
        </header>

        <!------------------------------------------------------------->


        <!-- nav left bar -->
        
        <div class="nav-container">
            <a href="studentprofile.html" class="nav-bullet">
                <i class="fa-regular fa-user"></i>
                <span>Profile</span>
            </a>
            <a href="#" class="nav-bullet">
                <i class="fa-solid fa-people-group"></i>
                <span>Team</span>
            </a>



            <a href="editprofile.html" class="nav-bullet">
                <i class="fa-solid fa-user-pen"></i>
                <span>Edit Profile</span>
            </a>
            <a href="index.html" class="nav-bullet">
                <i class='bx bx-log-out-circle'></i>
                <span>Log Out</span>
            </a>
        </div>

        <!------------------------------------------------------------->
        

        <div class="profile">

<!-- left card ---------------------------------->
            <div class="ProjectProfile">

                <div class="ProjectTitle">
                    <div class="identity">
                        <h3 class="Project_name" id="teamName">
                            AUTO GRAD
                            <i class="fa-solid fa-pen-to-square edit-icon" onclick="editTeamName()" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…"></i>
                        </h3>
                        <input type="text" id="teamNameInput" name="teamName" style="display: none;" />
                    </div>

                    <div class="imgbox">
                        <img id="teamLogo" src="/images/logo.png" alt="Team Logo">
                        <div class="change-logo-btn">
                            <label for="logoUpload" class="change-logo-label">
                                <i class="fa-solid fa-camera"></i>   Logo
                            </label>
                            <input type="file" id="logoUpload" style="display: none;" onchange="changeTeamLogo(event)">
                        </div>
                    </div>
                </div>

                <div class="bio" id="teamBio">
                    senior professor with 10 years of experience supervising graduation projects...
                    <i class="fa-solid fa-pen-to-square edit-icon" onclick="editBio()" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Ø¨Ø°Ø©"></i>
                </div>
                <textarea id="teamBioInput" style="display: none; width: 100%; margin-top: 10px;" rows="4"></textarea>
                <button id="saveBioBtn" style="display: none;" onclick="saveBio()">Ø­ÙØ¸</button>

                
                <div class="academicInfo">

                    <div class="UploadProposal">
                        <div class="upload-preview-row" id="uploadPreviewRow">
                            <label class="upload-box" for="fileInput">
                                <i class="fas fa-upload"></i>
                            </label>
                            <div id="previewContainer" style="display: flex; gap: 20px; flex-wrap: wrap;"></div>
                        </div>
                            <input type="file" id="fileInput" name="files" multiple />
                        <div class="buttons">
                            <button class="send-btn" id="sendBtn">Submit</button>
                        </div>
                        <div class="message" id="successMessage">âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø¨Ù†Ø¬Ø§Ø­!</div>
                    </div>

                </div>


                <div class="DoctorFeedback">
                    <section class="feedback-section">
                        <h2>Doctor FeedbacksğŸ“  </h2>
                        
                        <div class="feedback-card success">
                            <div class="feedback-header">
                            <div class="doctor-info">
                                <img src="https://i.pravatar.cc/40?u=doctor1" alt="Ø¯ÙƒØªÙˆØ±" />
                                <strong>Ø¯. Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ</strong>
                            </div>
                            <span class="feedback-date">2025-04-17</span>
                            </div>
                            <div class="feedback-body">
                            âœ… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ù…ØªØ§Ø²ØŒ Ù…Ø­ØªØ§Ø¬ÙŠÙ† ØªØ­Ø³ÙŠÙ† UI ØµÙØ­Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„.
                            </div>
                        </div>
                        
                        <div class="feedback-card warning">
                            <div class="feedback-header">
                            <div class="doctor-info">
                                <img src="https://i.pravatar.cc/40?u=doctor2" alt="Ø¯ÙƒØªÙˆØ±" />
                                <strong>Ø¯. Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³ÙŠØ¯</strong>
                            </div>
                            <span class="feedback-date">2025-04-14</span>
                            </div>
                            <div class="feedback-body">
                            âš ï¸ Ø­Ø§ÙˆÙ„ÙˆØ§ ØªØ±ÙØ¹ÙˆØ§ Ù…Ù„ÙØ§Øª Ø§Ù„Ù€ Demo Ù‚Ø¨Ù„ Ø§Ù„Ø³ÙŠÙ…ÙŠÙ†Ø§Ø± Ø§Ù„Ø¬Ø§ÙŠ Ø¨ÙŠÙˆÙ…ÙŠÙ†.
                            </div>
                        </div>
                        </section>
                    
                </div>


            </div>

<!---------------------------------------------------------------------------->


<!-- right card ----------------------------------->
            <div class="team">
                <h3>Registered Teams</h3>
                <hr>
                <div class="Members_stack">
                    <div class="team-card" id="leader">
                        <div class="team-logo">
                            <img src="pics/avatar.png" alt="Team Logo">
                        </div>
                        <div class="team-name">
                            <h3>Kareem Ashraaf</h3>
                            <p> 200017722</p>
                        </div>
                    </div>
                    <div class="team-card">
                        <div class="team-logo">
                            <img src="pics/avatar.png" alt="Team Logo">
                        </div>
                        <div class="team-name">
                            <h3>Ibrahem Mohamed Omara</h3>
                            <p> 20017723</p>
                        </div>
                        <button class="remove_btn"> <i class='bx bx-x-circle' ></i></button>
                    </div>
                    <div class="team-card">
                        <div class="team-logo">
                            <img src="pics/avatar.png" alt="Team Logo">
                        </div>
                        <div class="team-name">
                            <h3>Youssef Mohamed Ramadan</h3>
                            <p> 200017720</p>
                        </div>
                        <button class="remove_btn"> <i class='bx bx-x-circle' ></i></button>
                    </div>
                    <div class="team-card">
                        <div class="team-logo">
                            <img src="pics/avatar.png" alt="Team Logo">
                        </div>
                        <div class="team-name">
                            <h3>Ahmed Mahmoud Abouelmawahwb </h3>
                            <p> 200018900</p>
                        </div>
                        <button class="remove_btn"> <i class='bx bx-x-circle' ></i></button>
                    </div>
                    
                    <div class="team-card">
                        <div class="team-logo">
                            <img src="images/logoW.png" alt="Team Logo">
                        </div>
                        <div class="team-name">
                            <h3>Abd-elrahman Shehata </h3>
                            <p> 200018900</p>
                        </div>
                        <button class="remove_btn"> <i class='bx bx-x-circle' ></i></button>
                    </div>
                </div>

                <!-- Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯ -->
                <div class="add-member-btn">
                    <button><a href="PickTeam.html"><i class='bx bx-plus'></i></a></button>
                </div>

                            <!-- Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ† -->
                <div class="supervisors-block">
                <div class="supervisors">
                    <div class="supervisor">
                    <img src="https://i.pravatar.cc/80?u=super1" alt="Ù…Ø´Ø±Ù" />
                    <div>
                        <p><strong>DR/ Alaa Eldeen</strong></p>
                        <span>DOC</span>
                    </div>
                    </div>

                    <div class="supervisor">
                    <img src="https://i.pravatar.cc/80?u=super2" alt="Ù…Ø³Ø§Ø¹Ø¯ Ù…Ø´Ø±Ù" />
                    <div>
                        <p><strong>Eng/ Aya Taha</strong></p>
                        <span> T.A</span>
                    </div>
                    </div>


                </div>
                <div class="add-member-btn">
                    <button><a href="PickTeam.html"><i class='bx bx-plus'></i></a></button>
                </div> 
                </div>

            </div>
        </div>
    </div>

    <script>
        const fileInput = document.getElementById('fileInput');
        const previewContainer = document.getElementById('previewContainer');
        const sendBtn = document.getElementById('sendBtn');
        const successMessage = document.getElementById('successMessage');

        let selectedFiles = [];

        fileInput.addEventListener('change', () => {
            successMessage.style.display = 'none';

            selectedFiles = [...selectedFiles, ...Array.from(fileInput.files)];
            renderPreviews();

            fileInput.value = ''; // clear input to allow re-adding same file again if needed
        });

        function renderPreviews() {
            previewContainer.innerHTML = '';

            selectedFiles.forEach((file, index) => {
            const previewItem = document.createElement('div');
            previewItem.classList.add('preview-item');

            // remove button
            const removeBtn = document.createElement('button');
            removeBtn.classList.add('remove-btn');
            removeBtn.innerHTML = 'Ã—';
            removeBtn.addEventListener('click', () => {
                selectedFiles.splice(index, 1);
                renderPreviews();
            });

            previewItem.appendChild(removeBtn);

            // image or icon
            if (file.type.startsWith('image/')) {
                const img = document.createElement('img');
                img.src = URL.createObjectURL(file);
                previewItem.appendChild(img);
            } else {
                const icon = document.createElement('i');
                icon.className = "fas fa-file-alt fa-3x";
                icon.style.color = "#007bff";
                previewItem.appendChild(icon);
            }

            // progress bar container
            const progressContainer = document.createElement('div');
            progressContainer.classList.add('progress-bar-container');
            const progressBar = document.createElement('div');
            progressBar.classList.add('progress-bar');
            progressContainer.appendChild(progressBar);
            previewItem.appendChild(progressContainer);

            // simulate upload
            setTimeout(() => {
                progressBar.style.width = '100%'; // simulate full progress
            }, 500);

            // filename
            const name = document.createElement('div');
            name.classList.add('file-name');
            name.textContent = file.name;
            previewItem.appendChild(name);

            previewContainer.appendChild(previewItem);
            });
        }

        sendBtn.addEventListener('click', () => {
            if (selectedFiles.length === 0) {
            alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± Ù…Ù„ÙØ§Øª Ø£ÙˆÙ„Ø§Ù‹");
            } else {
            successMessage.style.display = 'block';
            }
        });





            // Ù„Ù…Ø§ ÙŠØ¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø­Ø°Ù
        document.querySelectorAll('.remove_btn').forEach(button => {
        button.addEventListener('click', function () {
            const memberRow = this.closest('.team-card');
            memberRow.remove();
        });
        });


        // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù… Ùˆ Ø§Ù„Ù„ÙˆØ¬Ùˆ Ùˆ Ø§Ù„Ø¨Ø§ÙŠÙˆ 
        const editTeamUrl = 'https://autograd3-daayg5argwb5czav.uaenorth-01.azurewebsites.net/api/Team/EditTeam';

        let api;
        fetch(`${editTeamUrl}`).then(res=>{console.log(res.status);return res.json()}).then(data=>api=data);
        function changeTeamLogo(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById("teamLogo").src = e.target.result;
                    api.teamLogo = e.target.result;
                    sendUpdate();
                };
                reader.readAsDataURL(file);
            }
        }

        function editTeamName() {
            const nameElement = document.getElementById("teamName");
            const input = document.getElementById("teamNameInput");
            input.value = nameElement.innerText.trim();
            nameElement.style.display = "none";
            input.style.display = "inline";
            input.onblur = function () {
                nameElement.innerHTML = input.value + `<i class="fa-solid fa-pen-to-square edit-icon" onclick="editTeamName()" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…"></i>`;
                input.style.display = "none";
                nameElement.style.display = "block";
                api.teamName = input.value;
                sendUpdate();
            };
        }

        function editBio() {
            const bio = document.getElementById("teamBio");
            const input = document.getElementById("teamBioInput");
            const saveBtn = document.getElementById("saveBioBtn");
            input.value = bio.innerText.trim();
            bio.style.display = "none";
            input.style.display = "block";
            saveBtn.style.display = "inline-block";
        }

        function saveBio() {
            const input = document.getElementById("teamBioInput");
            const bio = document.getElementById("teamBio");
            const saveBtn = document.getElementById("saveBioBtn");
            bio.innerHTML = input.value + `<i class="fa-solid fa-pen-to-square edit-icon" onclick="editBio()" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Ø¨Ø°Ø©"></i>`;
            bio.style.display = "block";
            input.style.display = "none";
            saveBtn.style.display = "none";
            api.teamBio = input.value;
            sendUpdate();
        }


            // Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯Ø¨Ø§Ùƒ Ù…Ù† localStorage
    const feedbackContainer = document.querySelector(".DoctorFeedback .feedback-section");

function renderFeedback() {
    const feedbacks = JSON.parse(localStorage.getItem("teamFeedbacks") || "[]");

    feedbacks.forEach(fb => {
        const card = document.createElement("div");
        card.className = "feedback-card success";
        card.innerHTML = `
            <div class="feedback-header">
                <div class="doctor-info">
                    <img src="https://i.pravatar.cc/40?u=${encodeURIComponent(fb.doctor)}" alt="Ø¯ÙƒØªÙˆØ±" />
                    <strong>${fb.doctor}</strong>
                </div>
                <span class="feedback-date">${fb.date}</span>
            </div>
            <div class="feedback-body">
                âœ… ${fb.content}
            </div>
        `;
        feedbackContainer.appendChild(card);
    });
}
function sendUpdate(){
    const response = fetch(`${editTeamUrl}`, {
        method: "POST",
        headers: "application/json",
        body: JSON.stringify(api)
    })
    console.log(response.status);
}

// ØªØ´ØºÙŠÙ„Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø©
renderFeedback();


    </script>
    
</body>
</html>